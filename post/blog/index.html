<!doctype html>
<html lang="en-us">
  <head>
    <title>Blog // My New Hugo Site</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.83.1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="https://loftytan.github.io/css/main.min.88e7083eff65effb7485b6e6f38d10afbec25093a6fac42d734ce9024d3defbd.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Blog"/>
<meta name="twitter:description" content="第1章 框架搭建 学习目标   了解电商
1.市场走向 2.技术特点   了解畅购架构
1.微服务架构 2.各个服务调用 3.各个服务公共组件抽取   ==了解畅购工程结构[重点]==
1.业务独立工程 2.公共抽取 3.数据依赖组件 4.分布式事务依赖组件 5.微服务网关 6.oauth2.0   畅购工程搭建
  商品微服务搭建
1.品牌的增删改查 2.通用Mapper&#43;PageHelper   ==品牌增删改查==[通用Mapper&#43;PageHelper]
  1. 走进电商 1.1 电商行业分析 近年来，世界经济正向数字化转型，大力发展数字经济成为全球共识。党的十九大报告明确提出要建设“数字中国”“网络强国”，我国数字经济发展进入新阶段，市场规模位居全球第二，数字经济与实体经济深度融合，有力促进了供给侧结构性改革。电子商务是数字经济的重要组成部分，是数字经济最活跃、最集中的表现形式之一。2017年，在政府和市场共同推动下，我国电子商务发展更加注重效率、质量和创新，取得了一系列新的进展，在壮大数字经济、共建“一带一路”、助力乡村振兴、带动创新创业、促进经济转型升级等诸多方面发挥了重要作用，成为我国经济增长的新动力。 2017年，我国电子商务交易规模继续扩大，并保持高速增长态势。国家统计局数据显示，2017年全国电子商务交易额达29.16万亿元，同比增长11.7%；网上零售额7.18万亿元，同比增长32.2%。我国电子商务优势进一步扩大，网络零售规模全球最大、产业创新活力世界领先。数据显示，截止2017年底，全国网络购物用户规模达5.33亿，同比增长14.3%；非银行支付机构发生网络支付金额达143.26万亿元，同比增长44.32%；全国快递服务企业业务量累计完成400.6亿件，同比增长28%；电子商务直接从业人员和间接带动就业达4250万人。
2018天猫全天成交额记录
1.2 电商系统技术特点   技术新
  技术范围广
  分布式
  高并发、集群、负载均衡、高可用
  海量数据
  业务复杂
  系统安全
  1.3 主要电商模式 B2B"/>

    <meta property="og:title" content="Blog" />
<meta property="og:description" content="第1章 框架搭建 学习目标   了解电商
1.市场走向 2.技术特点   了解畅购架构
1.微服务架构 2.各个服务调用 3.各个服务公共组件抽取   ==了解畅购工程结构[重点]==
1.业务独立工程 2.公共抽取 3.数据依赖组件 4.分布式事务依赖组件 5.微服务网关 6.oauth2.0   畅购工程搭建
  商品微服务搭建
1.品牌的增删改查 2.通用Mapper&#43;PageHelper   ==品牌增删改查==[通用Mapper&#43;PageHelper]
  1. 走进电商 1.1 电商行业分析 近年来，世界经济正向数字化转型，大力发展数字经济成为全球共识。党的十九大报告明确提出要建设“数字中国”“网络强国”，我国数字经济发展进入新阶段，市场规模位居全球第二，数字经济与实体经济深度融合，有力促进了供给侧结构性改革。电子商务是数字经济的重要组成部分，是数字经济最活跃、最集中的表现形式之一。2017年，在政府和市场共同推动下，我国电子商务发展更加注重效率、质量和创新，取得了一系列新的进展，在壮大数字经济、共建“一带一路”、助力乡村振兴、带动创新创业、促进经济转型升级等诸多方面发挥了重要作用，成为我国经济增长的新动力。 2017年，我国电子商务交易规模继续扩大，并保持高速增长态势。国家统计局数据显示，2017年全国电子商务交易额达29.16万亿元，同比增长11.7%；网上零售额7.18万亿元，同比增长32.2%。我国电子商务优势进一步扩大，网络零售规模全球最大、产业创新活力世界领先。数据显示，截止2017年底，全国网络购物用户规模达5.33亿，同比增长14.3%；非银行支付机构发生网络支付金额达143.26万亿元，同比增长44.32%；全国快递服务企业业务量累计完成400.6亿件，同比增长28%；电子商务直接从业人员和间接带动就业达4250万人。
2018天猫全天成交额记录
1.2 电商系统技术特点   技术新
  技术范围广
  分布式
  高并发、集群、负载均衡、高可用
  海量数据
  业务复杂
  系统安全
  1.3 主要电商模式 B2B" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://loftytan.github.io/post/blog/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-06-10T08:41:20&#43;08:00" />
<meta property="article:modified_time" content="2021-06-10T08:41:20&#43;08:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="https://loftytan.github.io/"><img class="app-header-avatar" src="/avatar.jpg" alt="John Doe" /></a>
      <h1>My New Hugo Site</h1>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc vehicula turpis sit amet elit pretium.</p>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Blog</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jun 10, 2021
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          7 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="第1章-框架搭建">第1章 框架搭建</h1>
<h2 id="学习目标">学习目标</h2>
<ul>
<li>
<p>了解电商</p>
<pre><code>1.市场走向
2.技术特点
</code></pre></li>
<li>
<p>了解畅购架构</p>
<pre><code>1.微服务架构
2.各个服务调用
3.各个服务公共组件抽取
</code></pre></li>
<li>
<p>==了解畅购工程结构[重点]==</p>
<pre><code>1.业务独立工程
2.公共抽取
3.数据依赖组件
4.分布式事务依赖组件
5.微服务网关
6.oauth2.0
</code></pre></li>
<li>
<p>畅购工程搭建</p>
</li>
<li>
<p>商品微服务搭建</p>
<pre><code>1.品牌的增删改查
2.通用Mapper+PageHelper
</code></pre></li>
<li>
<p>==品牌增删改查==[通用Mapper+PageHelper]</p>
</li>
</ul>
<h2 id="1-走进电商">1. 走进电商</h2>
<h3 id="11-电商行业分析">1.1 电商行业分析</h3>
<p>近年来，世界经济正向数字化转型，大力发展数字经济成为全球共识。党的十九大报告明确提出要建设“数字中国”“网络强国”，我国数字经济发展进入新阶段，市场规模位居全球第二，数字经济与实体经济深度融合，有力促进了供给侧结构性改革。电子商务是数字经济的重要组成部分，是数字经济最活跃、最集中的表现形式之一。2017年，在政府和市场共同推动下，我国电子商务发展更加注重效率、质量和创新，取得了一系列新的进展，在壮大数字经济、共建“一带一路”、助力乡村振兴、带动创新创业、促进经济转型升级等诸多方面发挥了重要作用，成为我国经济增长的新动力。
2017年，我国电子商务交易规模继续扩大，并保持高速增长态势。国家统计局数据显示，2017年全国电子商务交易额达29.16万亿元，同比增长11.7%；网上零售额7.18万亿元，同比增长32.2%。我国电子商务优势进一步扩大，网络零售规模全球最大、产业创新活力世界领先。数据显示，截止2017年底，全国网络购物用户规模达5.33亿，同比增长14.3%；非银行支付机构发生网络支付金额达143.26万亿元，同比增长44.32%；全国快递服务企业业务量累计完成400.6亿件，同比增长28%；电子商务直接从业人员和间接带动就业达4250万人。</p>
<p><img src="image%5C1559552887142.png" alt="1559552887142"></p>
<p>2018天猫全天成交额记录</p>
<p><img src="image%5C1559553569582.png" alt="1559553569582"></p>
<h3 id="12-电商系统技术特点">1.2 电商系统技术特点</h3>
<ul>
<li>
<p>技术新</p>
</li>
<li>
<p>技术范围广</p>
</li>
<li>
<p>分布式</p>
</li>
<li>
<p>高并发、集群、负载均衡、高可用</p>
</li>
<li>
<p>海量数据</p>
</li>
<li>
<p>业务复杂</p>
</li>
<li>
<p>系统安全</p>
</li>
</ul>
<h3 id="13-主要电商模式">1.3 主要电商模式</h3>
<p><strong>B2B</strong></p>
<pre><code>B2B （ Business to Business）是指进行电子商务交易的供需双方都是商家（或企业、公司），她（他）们使用了互联网的技术或各种商务网络平台，完成商务交易的过程。电子商务是现代 B2B marketing的一种具体主要的表现形式。

案例：阿里巴巴、慧聪网
</code></pre><p><strong>C2C</strong></p>
<pre><code>C2C即 Customer（Consumer） to Customer（Consumer），意思就是消费者个人间的电子商务行为。比如一个消费者有一台电脑，通过网络进行交易，把它出售给另外一个消费者，此种交易类型就称为C2C电子商务。

案例：淘宝、易趣、瓜子二手车
</code></pre><p><strong>B2C</strong></p>
<pre><code>B2C是Business-to-Customer的缩写，而其中文简称为“商对客”。“商对客”是电子商务的一种模式，也就是通常说的直接面向消费者销售产品和服务商业零售模式。这种形式的电子商务一般以网络零售业为主，主要借助于互联网开展在线销售活动。B2C即企业通过互联网为消费者提供一个新型的购物环境——网上商店，消费者通过网络在网上购物、网上支付等消费行为。

案例：唯品会、乐蜂网
</code></pre><p><strong>C2B</strong></p>
<pre><code>C2B（Consumer to Business，即消费者到企业），是互联网经济时代新的商业模式。这一模式改变了原有生产者（企业和机构）和消费者的关系，是一种消费者贡献价值（Create Value）， 企业和机构消费价值（Consume Value）。

C2B模式和我们熟知的供需模式（DSM, Demand SupplyModel）恰恰相反，真正的C2B 应该先有消费者需求产生而后有企业生产，即先有消费者提出需求，后有生产企业按需求组织生产。通常情况为消费者根据自身需求定制产品和价格，或主动参与产品设计、生产和定价，产品、价格等彰显消费者的个性化需求，生产企业进行定制化生产。

案例：海尔商城、 尚品宅配
</code></pre><p><strong>O2O</strong></p>
<pre><code>O2O即Online To Offline（在线离线/线上到线下），是指将线下的商务机会与互联网结合，让互联网成为线下交易的平台，这个概念最早来源于美国。O2O的概念非常广泛，既可涉及到线上，又可涉及到线下,可以通称为O2O。主流商业管理课程均对O2O这种新型的商业模式有所介绍及关注。

案例：美团、饿了吗
</code></pre><p><strong>F2C</strong></p>
<pre><code>F2C指的是Factory to customer，即从厂商到消费者的电子商务模式。
</code></pre><p><strong>B2B2C</strong></p>
<pre><code>B2B2C是一种电子商务类型的网络购物商业模式，B是BUSINESS的简称，C是CUSTOMER的简称，第一个B指的是商品或服务的供应商，第二个B指的是从事电子商务的企业，C则是表示消费者。

案例：京东商城、天猫商城
注：我们《畅购电商系统开发》课程采用B2C模式，之后的项目实战《品优购电商系统开发实战》采用B2B2C模式。
</code></pre><h2 id="2-畅购-需求分析与系统设计">2. 畅购-需求分析与系统设计</h2>
<h3 id="21-需求分析">2.1 需求分析</h3>
<p>网站前台静态原型演示，打开<code>资料\页面\前台\project-changgou-portal-fis3-master</code>，首页<code>index.html</code></p>
<p><img src="image%5C1559111851979.png" alt="1559111851979"></p>
<p>网站管理后台静态原型演示:http://czpm.itcast.cn/青橙后台/#g=1&amp;p=后台首页</p>
<p><img src="image%5C1559112046165.png" alt="1559112046165"></p>
<p>打开<code>资料\页面\后台\project-changgou-cmm-fis3-master\pages</code>,首页<code>all-medical-main.html</code></p>
<p><img src="image%5C1559111970498.png" alt="1559111970498"></p>
<h3 id="22-系统设计">2.2 系统设计</h3>
<p>畅购商城属于B2C电商模式，运营商将自己的产品发布到网站上，会员注册后，在网站上将商品添加到购物车，并且下单，完成线上支付，用户还可以参与秒杀抢购。</p>
<h4 id="221-前后端分离">2.2.1 前后端分离</h4>
<p>网站后台的部分采用前后端分离方式。</p>
<p>以前的JavaWeb项目大多数都是java程序员又当爹又当妈，又搞前端，又搞后端。随着时代的发展，渐渐的许多大中小公司开始把前后端的界限分的越来越明确，前端工程师只管前端的事情，后端工程师只管后端的事情。正所谓术业有专攻，一个人如果什么都会，那么他毕竟什么都不精。</p>
<p><strong>对于后端java工程师：</strong></p>
<p>把精力放在设计模式，spring+springmvc，linux，mysql事务隔离与锁机制，mongodb，http/tcp，多线程，分布式架构，弹性计算架构，微服务架构，java性能优化，以及相关的项目管理等等。</p>
<p><strong>对于前端工程师：</strong></p>
<p>把精力放在html5，css3，vuejs，webpack，nodejs，Google V8引擎，javascript多线程，模块化，面向切面编程，设计模式，浏览器兼容性，性能优化等等。</p>
<p><img src="image%5C1559553886871.png" alt="1559553886871"></p>
<p>我们在本课程中提供与项目课程配套的管理后台的前端代码，但是不讲解前端的内容。这样我们会将更多的精力放在<strong>后端代码</strong>的开发上！</p>
<h4 id="222-技术架构">2.2.2 技术架构</h4>
<p><img src="image%5C1560087134452.png" alt="1560087134452"></p>
<h4 id="223-系统架构图">2.2.3 系统架构图</h4>
<p><img src="image%5C1560090475333.png" alt="1560090475333"></p>
<h2 id="3-畅购-框架搭建">3 畅购-框架搭建</h2>
<h3 id="31-环境准备">3.1 环境准备</h3>
<p>（1）VMware Workstation Pro安装centos7 镜像</p>
<p>（2）安装docker</p>
<p>（3）拉取mySQL镜像，并创建容器</p>
<p>（4）客户端连接mysql容器，建库建表（建库建表语句在资源文件夹中提供）</p>
<p>虚拟机数据：</p>
<ul>
<li>
<p>虚拟机IP:192.168.211.132</p>
</li>
<li>
<p>虚拟机账号：root     密码：123456</p>
</li>
<li>
<p>数据库端口:3306</p>
</li>
<li>
<p>数据库账号：root   密码：123456</p>
</li>
</ul>
<p>数据库脚本：<code>资料\数据库脚本</code></p>
<p><img src="image%5C1564094555825.png" alt="1564094555825"></p>
<h3 id="32-项目结构说明">==3.2 项目结构说明==</h3>
<p><img src="image%5C1559113404367.png" alt="1559113404367"></p>
<p>结构说明：</p>
<p>changgou-gateway</p>
<pre><code>网关模块，根据网站的规模和需要，可以将综合逻辑相关的服务用网关路由组合到一起。在这里还可以做鉴权和限流相关操作。
</code></pre><p>changgou-service</p>
<pre><code>微服务模块，该模块用于存放所有独立的微服务工程。
</code></pre><p>changgou-service_api</p>
<pre><code>对应工程的JavaBean、Feign、以及Hystrix配置，该工程主要对外提供依赖。
</code></pre><p>changgou-transaction-fescar</p>
<pre><code>分布式事务模块，将分布式事务抽取到该工程中，任何工程如需要使用分布式事务，只需依赖该工程即可。
</code></pre><p>changgou-web</p>
<pre><code>web服务工程，对应功能模块如需要调用多个微服务，可以将他们写入到该模块中，例如网站后台、网站前台等
</code></pre><h3 id="33-公共工程搭建">3.3 公共工程搭建</h3>
<h4 id="331-父工程搭建">3.3.1 父工程搭建</h4>
<p>创建父工程 changgou-parent  ,pom.xml文件中增加配置</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#f92672">&lt;project</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
         <span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
         <span style="color:#a6e22e">xsi:schemaLocation=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;modelVersion&gt;</span>4.0.0<span style="color:#f92672">&lt;/modelVersion&gt;</span>

    <span style="color:#f92672">&lt;groupId&gt;</span>com.changgou<span style="color:#f92672">&lt;/groupId&gt;</span>
    <span style="color:#f92672">&lt;artifactId&gt;</span>changgou-parent<span style="color:#f92672">&lt;/artifactId&gt;</span>
    <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>

    <span style="color:#f92672">&lt;parent&gt;</span>
        <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
        <span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-parent<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;version&gt;</span>2.1.4.RELEASE<span style="color:#f92672">&lt;/version&gt;</span>
    <span style="color:#f92672">&lt;/parent&gt;</span>

    <span style="color:#f92672">&lt;properties&gt;</span>
        <span style="color:#f92672">&lt;skipTests&gt;</span>true<span style="color:#f92672">&lt;/skipTests&gt;</span>
    <span style="color:#f92672">&lt;/properties&gt;</span>

    <span style="color:#75715e">&lt;!--依赖包--&gt;</span>
    <span style="color:#f92672">&lt;dependencies&gt;</span>
        <span style="color:#75715e">&lt;!--测试包--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-test<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>

        <span style="color:#75715e">&lt;!--fastjson--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>com.alibaba<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>fastjson<span style="color:#f92672">&lt;/artifactId&gt;</span>
            <span style="color:#f92672">&lt;version&gt;</span>1.2.51<span style="color:#f92672">&lt;/version&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>

        <span style="color:#75715e">&lt;!--swagger文档--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>io.springfox<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>springfox-swagger2<span style="color:#f92672">&lt;/artifactId&gt;</span>
            <span style="color:#f92672">&lt;version&gt;</span>2.6.1<span style="color:#f92672">&lt;/version&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>

        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>io.springfox<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>springfox-swagger-ui<span style="color:#f92672">&lt;/artifactId&gt;</span>
            <span style="color:#f92672">&lt;version&gt;</span>2.6.1<span style="color:#f92672">&lt;/version&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>

        <span style="color:#75715e">&lt;!--
</span><span style="color:#75715e">            http://localhost:9011/swagger-ui.html
</span><span style="color:#75715e">        --&gt;</span>
    <span style="color:#f92672">&lt;/dependencies&gt;</span>

    <span style="color:#f92672">&lt;dependencyManagement&gt;</span>
        <span style="color:#f92672">&lt;dependencies&gt;</span>
            <span style="color:#f92672">&lt;dependency&gt;</span>
                <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#f92672">&lt;/groupId&gt;</span>
                <span style="color:#f92672">&lt;artifactId&gt;</span>spring-cloud-dependencies<span style="color:#f92672">&lt;/artifactId&gt;</span>
                <span style="color:#f92672">&lt;version&gt;</span>Greenwich.SR1<span style="color:#f92672">&lt;/version&gt;</span>
                <span style="color:#f92672">&lt;type&gt;</span>pom<span style="color:#f92672">&lt;/type&gt;</span>
                <span style="color:#f92672">&lt;scope&gt;</span>import<span style="color:#f92672">&lt;/scope&gt;</span>
            <span style="color:#f92672">&lt;/dependency&gt;</span>
        <span style="color:#f92672">&lt;/dependencies&gt;</span>
    <span style="color:#f92672">&lt;/dependencyManagement&gt;</span>
<span style="color:#f92672">&lt;/project&gt;</span>
</code></pre></div><p>删除src文件夹</p>
<h4 id="332-其他公共模块搭建">3.3.2 其他公共模块搭建</h4>
<p>创建changgou-gateway、changgou-service、changgou-service-api、changgou-web工程，工程全部为pom工程，并将所有工程的src文件删除。</p>
<p>pom.xml中打pom包</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;packaging&gt;</span>pom<span style="color:#f92672">&lt;/packaging&gt;</span>
</code></pre></div><p>项目结构如下：</p>
<p><img src="image%5C1564024579642.png" alt="1564024579642"></p>
<h3 id="34-eureka微服务搭建">3.4 Eureka微服务搭建</h3>
<h4 id="341-pomxml依赖">3.4.1 pom.xml依赖</h4>
<p>创建模块changgou-eureka ，pom.xml引入依赖</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#f92672">&lt;project</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
         <span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
         <span style="color:#a6e22e">xsi:schemaLocation=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;parent&gt;</span>
        <span style="color:#f92672">&lt;artifactId&gt;</span>changgou_parent<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;groupId&gt;</span>com.changgou<span style="color:#f92672">&lt;/groupId&gt;</span>
        <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
    <span style="color:#f92672">&lt;/parent&gt;</span>
    <span style="color:#f92672">&lt;modelVersion&gt;</span>4.0.0<span style="color:#f92672">&lt;/modelVersion&gt;</span>
    <span style="color:#f92672">&lt;artifactId&gt;</span>changgou_eureka<span style="color:#f92672">&lt;/artifactId&gt;</span>

    <span style="color:#f92672">&lt;dependencies&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-eureka-server<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
    <span style="color:#f92672">&lt;/dependencies&gt;</span>
<span style="color:#f92672">&lt;/project&gt;</span>
</code></pre></div><h4 id="342-appliationyml配置">3.4.2 appliation.yml配置</h4>
<p>创建配置文件application.yml</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">server</span>:
  <span style="color:#f92672">port</span>: <span style="color:#ae81ff">7001</span>
<span style="color:#f92672">eureka</span>:
  <span style="color:#f92672">instance</span>:
    <span style="color:#f92672">hostname</span>: <span style="color:#ae81ff">127.0.0.1</span>
  <span style="color:#f92672">client</span>:
    <span style="color:#f92672">register-with-eureka</span>: <span style="color:#66d9ef">false</span>   <span style="color:#75715e">#是否将自己注册到eureka中</span>
    <span style="color:#f92672">fetch-registry</span>: <span style="color:#66d9ef">false</span>         <span style="color:#75715e">#是否从eureka中获取信息</span>
    <span style="color:#f92672">service-url</span>:
      <span style="color:#f92672">defaultZone</span>: <span style="color:#ae81ff">http://${eureka.instance.hostname}:${server.port}/eureka/</span>
</code></pre></div><h4 id="343-启动类配置">3.4.3 启动类配置</h4>
<p>创建包com.changgou  包下创建启动类EurekaApplication，代码如下：</p>
<p><img src="image%5C1560411732580.png" alt="1560411732580"></p>
<p>上图代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java"><span style="color:#a6e22e">@SpringBootApplication</span>
<span style="color:#a6e22e">@EnableEurekaServer</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EurekaApplication</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        SpringApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">run</span><span style="color:#f92672">(</span>EurekaApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>测试访问<code>http://localhost:7001/</code>,效果如下：</p>
<p><img src="image%5C1560412105435.png" alt="1560412105435"></p>
<h3 id="35-公共模块搭建">3.5 公共模块搭建</h3>
<h4 id="351-pomxml依赖">3.5.1 pom.xml依赖</h4>
<p>创建公共子模块changgou-common，pom.xml引入依赖</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#f92672">&lt;project</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
         <span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
         <span style="color:#a6e22e">xsi:schemaLocation=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;parent&gt;</span>
        <span style="color:#f92672">&lt;artifactId&gt;</span>changgou-parent<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;groupId&gt;</span>com.changgou<span style="color:#f92672">&lt;/groupId&gt;</span>
        <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
    <span style="color:#f92672">&lt;/parent&gt;</span>
    <span style="color:#f92672">&lt;modelVersion&gt;</span>4.0.0<span style="color:#f92672">&lt;/modelVersion&gt;</span>
    <span style="color:#f92672">&lt;artifactId&gt;</span>changgou-common<span style="color:#f92672">&lt;/artifactId&gt;</span>

    <span style="color:#f92672">&lt;dependencies&gt;</span>
        <span style="color:#75715e">&lt;!--web起步依赖--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-web<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
        <span style="color:#75715e">&lt;!-- redis 使用--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-data-redis<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
        <span style="color:#75715e">&lt;!--eureka-client--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-eureka-client<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
        <span style="color:#75715e">&lt;!--openfeign--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.cloud<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>spring-cloud-starter-openfeign<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
        <span style="color:#75715e">&lt;!--微信支付--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>com.github.wxpay<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>wxpay-sdk<span style="color:#f92672">&lt;/artifactId&gt;</span>
            <span style="color:#f92672">&lt;version&gt;</span>0.0.3<span style="color:#f92672">&lt;/version&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
        <span style="color:#75715e">&lt;!--httpclient支持--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>org.apache.httpcomponents<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>httpclient<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
    <span style="color:#f92672">&lt;/dependencies&gt;</span>
<span style="color:#f92672">&lt;/project&gt;</span>
</code></pre></div><p>公共子模块引入这些依赖后，其他微服务引入changgou-common后也自动引入了这些依赖</p>
<h4 id="352-常用对象">3.5.2 常用对象</h4>
<p>创建entity包 ，在entity包下创建返回状态码实体类==[StatusCode]==</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * 返回码
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StatusCode</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> OK <span style="color:#f92672">=</span> 20000<span style="color:#f92672">;</span><span style="color:#75715e">//成功
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> ERROR <span style="color:#f92672">=</span> 20001<span style="color:#f92672">;</span><span style="color:#75715e">//失败
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> LOGINERROR <span style="color:#f92672">=</span> 20002<span style="color:#f92672">;</span><span style="color:#75715e">//用户名或密码错误
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> ACCESSERROR <span style="color:#f92672">=</span> 20003<span style="color:#f92672">;</span><span style="color:#75715e">//权限不足
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> REMOTEERROR <span style="color:#f92672">=</span> 20004<span style="color:#f92672">;</span><span style="color:#75715e">//远程调用失败
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> REPERROR <span style="color:#f92672">=</span> 20005<span style="color:#f92672">;</span><span style="color:#75715e">//重复操作
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> NOTFOUNDERROR <span style="color:#f92672">=</span> 20006<span style="color:#f92672">;</span><span style="color:#75715e">//没有对应的抢购数据
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</code></pre></div><p>包下建立类==Result==用于微服务返回结果给前端</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * 返回结果实体类
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Result</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">boolean</span> flag<span style="color:#f92672">;</span><span style="color:#75715e">//是否成功
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> Integer code<span style="color:#f92672">;</span><span style="color:#75715e">//返回码
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> String message<span style="color:#f92672">;</span><span style="color:#75715e">//返回消息
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> T data<span style="color:#f92672">;</span><span style="color:#75715e">//返回数据
</span><span style="color:#75715e"></span>
    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Result</span><span style="color:#f92672">(</span><span style="color:#66d9ef">boolean</span> flag<span style="color:#f92672">,</span> Integer code<span style="color:#f92672">,</span> String message<span style="color:#f92672">,</span> Object data<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">flag</span> <span style="color:#f92672">=</span> flag<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">code</span> <span style="color:#f92672">=</span> code<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> message<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>T<span style="color:#f92672">)</span> data<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Result</span><span style="color:#f92672">(</span><span style="color:#66d9ef">boolean</span> flag<span style="color:#f92672">,</span> Integer code<span style="color:#f92672">,</span> String message<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">flag</span> <span style="color:#f92672">=</span> flag<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">code</span> <span style="color:#f92672">=</span> code<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> message<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Result</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">flag</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">code</span> <span style="color:#f92672">=</span> StatusCode<span style="color:#f92672">.</span><span style="color:#a6e22e">OK</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;操作成功!&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">// getter and setter.....
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</code></pre></div><p>在entity包下建立类用于承载分页的数据结果</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * 分页结果类
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PageResult</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">private</span> Long total<span style="color:#f92672">;</span><span style="color:#75715e">//总记录数
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> List<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> rows<span style="color:#f92672">;</span><span style="color:#75715e">//记录
</span><span style="color:#75715e"></span>
    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">PageResult</span><span style="color:#f92672">(</span>Long total<span style="color:#f92672">,</span> List<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> rows<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">total</span> <span style="color:#f92672">=</span> total<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">rows</span> <span style="color:#f92672">=</span> rows<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">PageResult</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">//getter and setter ......
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</code></pre></div><p>当然，我们还可以将其他工具类都一起倒入到工程中，以后会用到，将<code>资料\工具类</code>中的所有类直接导入到entity包下。</p>
<p><img src="image%5C1564023015741.png" alt="1564023015741"></p>
<h3 id="36-数据访问工程搭建">3.6 数据访问工程搭建</h3>
<p>创建公共模块changgou-common-db ，pom文件引入依赖</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#f92672">&lt;project</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
         <span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
         <span style="color:#a6e22e">xsi:schemaLocation=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;parent&gt;</span>
        <span style="color:#f92672">&lt;artifactId&gt;</span>changgou-parent<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;groupId&gt;</span>com.changgou<span style="color:#f92672">&lt;/groupId&gt;</span>
        <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
    <span style="color:#f92672">&lt;/parent&gt;</span>
    <span style="color:#f92672">&lt;modelVersion&gt;</span>4.0.0<span style="color:#f92672">&lt;/modelVersion&gt;</span>
    <span style="color:#f92672">&lt;artifactId&gt;</span>changgou-common-db<span style="color:#f92672">&lt;/artifactId&gt;</span>

    <span style="color:#75715e">&lt;!--依赖--&gt;</span>
    <span style="color:#f92672">&lt;dependencies&gt;</span>
        <span style="color:#75715e">&lt;!--对changgou-common的依赖--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>com.changgou<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>changgou-common<span style="color:#f92672">&lt;/artifactId&gt;</span>
            <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
        <span style="color:#75715e">&lt;!--通用mapper起步依赖--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>tk.mybatis<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>mapper-spring-boot-starter<span style="color:#f92672">&lt;/artifactId&gt;</span>
            <span style="color:#f92672">&lt;version&gt;</span>2.0.4<span style="color:#f92672">&lt;/version&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
        <span style="color:#75715e">&lt;!--MySQL数据库驱动--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>mysql<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>mysql-connector-java<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
        <span style="color:#75715e">&lt;!--mybatis分页插件--&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>com.github.pagehelper<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>pagehelper-spring-boot-starter<span style="color:#f92672">&lt;/artifactId&gt;</span>
            <span style="color:#f92672">&lt;version&gt;</span>1.2.3<span style="color:#f92672">&lt;/version&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
    <span style="color:#f92672">&lt;/dependencies&gt;</span>
<span style="color:#f92672">&lt;/project&gt;</span>
</code></pre></div><p>这个公共模块是连接mysql数据库的公共微服务模块，所以需要连接mysql的微服务都继承自此工程。</p>
<h3 id="37-商品微服务搭建">3.7 商品微服务搭建</h3>
<p>商品微服务主要是实现对商品的增删改查相关操作，以及商品相关信息的增删改查。</p>
<h4 id="371-公共组件工程搭建">==3.7.1 公共组件工程搭建==</h4>
<p>创建changgou-service-api子模块changgou-service-goods-api，并将<code>资料\javabean\changgou-service-goods-api</code>中的Pojo导入到工程中。</p>
<p><img src="image%5C1560416099767.png" alt="1560416099767"></p>
<p>修改父工程changgou-service-api的pom.xml，添加<code>persistence-api</code>和<code>changgou-common</code>的依赖，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;dependencies&gt;</span>
    <span style="color:#75715e">&lt;!--通用的common--&gt;</span>
    <span style="color:#f92672">&lt;dependency&gt;</span>
        <span style="color:#f92672">&lt;groupId&gt;</span>com.changgou<span style="color:#f92672">&lt;/groupId&gt;</span>
        <span style="color:#f92672">&lt;artifactId&gt;</span>changgou-common<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
    <span style="color:#f92672">&lt;/dependency&gt;</span>

    <span style="color:#75715e">&lt;!--每个工程都有Pojo，都需要用到该包对应的注解--&gt;</span>
    <span style="color:#f92672">&lt;dependency&gt;</span>
        <span style="color:#f92672">&lt;groupId&gt;</span>javax.persistence<span style="color:#f92672">&lt;/groupId&gt;</span>
        <span style="color:#f92672">&lt;artifactId&gt;</span>persistence-api<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;version&gt;</span>1.0<span style="color:#f92672">&lt;/version&gt;</span>
        <span style="color:#f92672">&lt;scope&gt;</span>compile<span style="color:#f92672">&lt;/scope&gt;</span>
    <span style="color:#f92672">&lt;/dependency&gt;</span>
<span style="color:#f92672">&lt;/dependencies&gt;</span>
</code></pre></div><h4 id="372-微服务工程搭建">3.7.2 微服务工程搭建</h4>
<p>修改changgou-service的pom.xml引入<code>changgou-common-db</code>的依赖，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--依赖--&gt;</span>
<span style="color:#f92672">&lt;dependencies&gt;</span>
    <span style="color:#f92672">&lt;dependency&gt;</span>
        <span style="color:#f92672">&lt;groupId&gt;</span>com.changgou<span style="color:#f92672">&lt;/groupId&gt;</span>
        <span style="color:#f92672">&lt;artifactId&gt;</span>changgou-common-db<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
    <span style="color:#f92672">&lt;/dependency&gt;</span>
<span style="color:#f92672">&lt;/dependencies&gt;</span>
</code></pre></div><p>在changgou-service中创建changgou-service-goods ，pom.xml引入依赖</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#f92672">&lt;project</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
         <span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
         <span style="color:#a6e22e">xsi:schemaLocation=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;parent&gt;</span>
        <span style="color:#f92672">&lt;artifactId&gt;</span>changgou-service<span style="color:#f92672">&lt;/artifactId&gt;</span>
        <span style="color:#f92672">&lt;groupId&gt;</span>com.changgou<span style="color:#f92672">&lt;/groupId&gt;</span>
        <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
    <span style="color:#f92672">&lt;/parent&gt;</span>
    <span style="color:#f92672">&lt;modelVersion&gt;</span>4.0.0<span style="color:#f92672">&lt;/modelVersion&gt;</span>
    <span style="color:#f92672">&lt;artifactId&gt;</span>changgou-service-goods<span style="color:#f92672">&lt;/artifactId&gt;</span>

    <span style="color:#75715e">&lt;!--依赖--&gt;</span>
    <span style="color:#f92672">&lt;dependencies&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>com.changgou<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>changgou-service-goods-api<span style="color:#f92672">&lt;/artifactId&gt;</span>
            <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
    <span style="color:#f92672">&lt;/dependencies&gt;</span>
<span style="color:#f92672">&lt;/project&gt;</span>
</code></pre></div><p>在resources下创建配置文件application.yml</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">server</span>:
  <span style="color:#f92672">port</span>: <span style="color:#ae81ff">18081</span>
<span style="color:#f92672">spring</span>:
  <span style="color:#f92672">application</span>:
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">goods</span>
  <span style="color:#f92672">datasource</span>:
    <span style="color:#f92672">driver-class-name</span>: <span style="color:#ae81ff">com.mysql.jdbc.Driver</span>
    <span style="color:#f92672">url</span>: <span style="color:#ae81ff">jdbc:mysql://192.168.211.132:3306/changgou_goods?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=UTC</span>
    <span style="color:#f92672">username</span>: <span style="color:#ae81ff">root</span>
    <span style="color:#f92672">password</span>: <span style="color:#ae81ff">123456</span>
<span style="color:#f92672">eureka</span>:
  <span style="color:#f92672">client</span>:
    <span style="color:#f92672">service-url</span>:
      <span style="color:#f92672">defaultZone</span>: <span style="color:#ae81ff">http://127.0.0.1:7001/eureka</span>
  <span style="color:#f92672">instance</span>:
    <span style="color:#f92672">prefer-ip-address</span>: <span style="color:#66d9ef">true</span>
<span style="color:#f92672">feign</span>:
  <span style="color:#f92672">hystrix</span>:
    <span style="color:#f92672">enabled</span>: <span style="color:#66d9ef">true</span>
<span style="color:#f92672">mybatis</span>:
  <span style="color:#f92672">configuration</span>:
    <span style="color:#f92672">map-underscore-to-camel-case</span>: <span style="color:#66d9ef">true</span>
  <span style="color:#f92672">mapper-locations</span>: <span style="color:#ae81ff">classpath:mapper/*Mapper.xml</span>
  <span style="color:#f92672">type-aliases-package</span>: <span style="color:#ae81ff">com.changgou.goods.pojo</span>
</code></pre></div><p>在包com.changgou.goods 包下创建启动类GoodsApplication，代码如下：</p>
<p><img src="image%5C1560416869439.png" alt="1560416869439"></p>
<p>上图代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JAVA" data-lang="JAVA"><span style="color:#a6e22e">@SpringBootApplication</span>
<span style="color:#a6e22e">@EnableEurekaClient</span>
<span style="color:#a6e22e">@MapperScan</span><span style="color:#f92672">(</span>basePackages <span style="color:#f92672">=</span> <span style="color:#f92672">{</span><span style="color:#e6db74">&#34;com.changgou.goods.dao&#34;</span><span style="color:#f92672">})</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GoodsApplication</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        SpringApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">run</span><span style="color:#f92672">(</span>GoodsApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p><em><strong>注意</strong></em> ：@MapperScan是<code>tk.mybatis.spring.annotation</code>包下的，用于扫描==Mapper==接口</p>
<p>启动<code>changgou-service-goods</code> 再访问<code>&lt;http://localhost:7001/&gt;</code>效果如下：</p>
<p><img src="image%5C1564037101313.png" alt="1564037101313"></p>
<h2 id="4-商品微服务-品牌增删改查">==4 商品微服务-品牌增删改查==</h2>
<h3 id="41-需求分析">4.1 需求分析</h3>
<p>创建商品微服务，实现对品牌表的增删改查功能。具体包括</p>
<p>（1）查询全部列表数据</p>
<p>（2）根据ID查询实体数据</p>
<p>（3）增加</p>
<p>（4）修改</p>
<p>（5）删除</p>
<p>（6）条件查询</p>
<p>（7）分页查询</p>
<p>（8）分页+条件查询</p>
<p>（9）公共异常处理</p>
<h3 id="42-表结构分析">4.2 表结构分析</h3>
<p>品牌表：tb_brand</p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段含义</th>
<th>字段类型</th>
<th>字段长度</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>品牌id</td>
<td>INT</td>
<td></td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>品牌名称</td>
<td>VARCHAR</td>
<td></td>
<td></td>
</tr>
<tr>
<td>image</td>
<td>品牌图片地址</td>
<td>VARCHAR</td>
<td></td>
<td></td>
</tr>
<tr>
<td>letter</td>
<td>品牌的首字母</td>
<td>CHAR</td>
<td></td>
<td></td>
</tr>
<tr>
<td>seq</td>
<td>排序</td>
<td>INT</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="43-代码实现">4.3 代码实现</h3>
<p>上面品牌表对应Brand实体类</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Table</span><span style="color:#f92672">(</span>name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tb_brand&#34;</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Brand</span> <span style="color:#66d9ef">implements</span> Serializable<span style="color:#f92672">{</span>
	<span style="color:#a6e22e">@Id</span>
	<span style="color:#66d9ef">private</span> Integer id<span style="color:#f92672">;</span><span style="color:#75715e">//品牌id
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">private</span> String name<span style="color:#f92672">;</span><span style="color:#75715e">//品牌名称
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">private</span> String image<span style="color:#f92672">;</span><span style="color:#75715e">//品牌图片地址
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">private</span> String letter<span style="color:#f92672">;</span><span style="color:#75715e">//品牌的首字母
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">private</span> Integer seq<span style="color:#f92672">;</span><span style="color:#75715e">//排序
</span><span style="color:#75715e"></span>	
	<span style="color:#75715e">// getter and setter  .....(省略)
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</code></pre></div><p>@Table和@Id都是JPA注解，@Table用于配置表与实体类的映射关系，@Id用于标识主键属性。</p>
<h4 id="431-品牌列表">4.3.1 品牌列表</h4>
<p>(1)Dao创建</p>
<p>在changgou-service-goods微服务下创建com.changgou.goods.dao.BrandMapper接口，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">BrandMapper</span> <span style="color:#66d9ef">extends</span> Mapper<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>继承了Mapper接口，就自动实现了增删改查的常用方法。</p>
<p>(2)业务层</p>
<p>创建com.changgou.goods.service.BrandService接口，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">BrandService</span> <span style="color:#f92672">{</span>

    <span style="color:#75715e">/***
</span><span style="color:#75715e">     * 查询所有品牌
</span><span style="color:#75715e">     * @return
</span><span style="color:#75715e">     */</span>
    List<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findAll</span><span style="color:#f92672">();</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>创建com.changgou.goods.service.impl.BrandServiceImpl实现类，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Service</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BrandServiceImpl</span> <span style="color:#f92672">{</span>

    <span style="color:#a6e22e">@Autowired</span>
    <span style="color:#66d9ef">private</span> BrandMapper brandMapper<span style="color:#f92672">;</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * 全部数据
</span><span style="color:#75715e">     * @return
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> List<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findAll</span><span style="color:#f92672">(){</span>
        <span style="color:#66d9ef">return</span> brandMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectAll</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>(3)控制层</p>
<p>控制层  com.changgou.goods包下创建controller包  ，包下创建类</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@RestController</span>
<span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/brand&#34;</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BrandController</span> <span style="color:#f92672">{</span>

    <span style="color:#a6e22e">@Autowired</span>
    <span style="color:#66d9ef">private</span> BrandService brandService<span style="color:#f92672">;</span>

    <span style="color:#75715e">/***
</span><span style="color:#75715e">     * 查询全部数据
</span><span style="color:#75715e">     * @return
</span><span style="color:#75715e">     */</span>
    <span style="color:#a6e22e">@GetMapping</span>
    <span style="color:#66d9ef">public</span> Result<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findAll</span><span style="color:#f92672">(){</span>
        List<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> brandList <span style="color:#f92672">=</span> brandService<span style="color:#f92672">.</span><span style="color:#a6e22e">findAll</span><span style="color:#f92672">();</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Result<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span> StatusCode<span style="color:#f92672">.</span><span style="color:#a6e22e">OK</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;查询成功&#34;</span><span style="color:#f92672">,</span>brandList<span style="color:#f92672">)</span> <span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>测试：http://localhost:18081/brand</p>
<p><img src="image%5C1560443629855.png" alt="1560443629855"></p>
<h4 id="432-根据id查询品牌">4.3.2 根据ID查询品牌</h4>
<p>(1)业务层</p>
<p>修改com.changgou.goods.service.BrandService接口，添加根据ID查询品牌数据方法，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * 根据ID查询
</span><span style="color:#75715e"> * @param id
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
Brand <span style="color:#a6e22e">findById</span><span style="color:#f92672">(</span>Integer id<span style="color:#f92672">);</span>
</code></pre></div><p>修改com.changgou.goods.service.impl.BrandServiceImpl新增方法，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * 根据ID查询
</span><span style="color:#75715e"> * @param id
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@Override</span>
<span style="color:#66d9ef">public</span> Brand <span style="color:#a6e22e">findById</span><span style="color:#f92672">(</span>Integer id<span style="color:#f92672">){</span>
    <span style="color:#66d9ef">return</span>  brandMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectByPrimaryKey</span><span style="color:#f92672">(</span>id<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>(2)控制层</p>
<p>BrandController新增方法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 根据ID查询品牌数据
</span><span style="color:#75715e"> * @param id
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@GetMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/{id}&#34;</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> Result<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findById</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@PathVariable</span> Integer id<span style="color:#f92672">){</span>
    <span style="color:#75715e">//根据ID查询
</span><span style="color:#75715e"></span>    Brand brand <span style="color:#f92672">=</span> brandService<span style="color:#f92672">.</span><span style="color:#a6e22e">findById</span><span style="color:#f92672">(</span>id<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Result<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>StatusCode<span style="color:#f92672">.</span><span style="color:#a6e22e">OK</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;查询成功&#34;</span><span style="color:#f92672">,</span>brand<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>测试：<a href="http://localhost:18081/brand/14026">http://localhost:18081/brand/14026</a></p>
<p><img src="image%5C1560443736710.png" alt="1560443736710"></p>
<h4 id="433-新增品牌">4.3.3 新增品牌</h4>
<p>(1)业务层</p>
<p>修改com.changgou.goods.service.BrandService，新增方法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 新增品牌
</span><span style="color:#75715e"> * @param brand
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>Brand brand<span style="color:#f92672">);</span>
</code></pre></div><p>修改com.changgou.goods.service.impl.BrandServiceImpl，新增增加品牌方法代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * 增加
</span><span style="color:#75715e"> * @param brand
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@Override</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>Brand brand<span style="color:#f92672">){</span>
    brandMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">insert</span><span style="color:#f92672">(</span>brand<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>(2) 控制层</p>
<p>BrandController新增方法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 新增品牌数据
</span><span style="color:#75715e"> * @param brand
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@PostMapping</span>
<span style="color:#66d9ef">public</span> Result <span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@RequestBody</span> Brand brand<span style="color:#f92672">){</span>
    brandService<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>brand<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Result<span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>StatusCode<span style="color:#f92672">.</span><span style="color:#a6e22e">OK</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;添加成功&#34;</span><span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>测试：http://localhost:18081/brand</p>
<p><img src="image%5C1560443988970.png" alt="1560443988970"></p>
<h4 id="434-修改品牌">4.3.4 修改品牌</h4>
<p>(1)业务层</p>
<p>需改com.changgou.goods.service.BrandService,添加修改品牌方法，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 修改品牌数据
</span><span style="color:#75715e"> * @param brand
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">update</span><span style="color:#f92672">(</span>Brand brand<span style="color:#f92672">);</span>
</code></pre></div><p>修改com.changgou.goods.service.impl.BrandServiceImpl，添加修改品牌方法，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * 修改
</span><span style="color:#75715e"> * @param brand
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@Override</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">update</span><span style="color:#f92672">(</span>Brand brand<span style="color:#f92672">){</span>
    brandMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">updateByPrimaryKey</span><span style="color:#f92672">(</span>brand<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>(2)控制层</p>
<p>BrandController新增方法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 修改品牌数据
</span><span style="color:#75715e"> * @param brand
</span><span style="color:#75715e"> * @param id
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@PutMapping</span><span style="color:#f92672">(</span>value<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/{id}&#34;</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> Result <span style="color:#a6e22e">update</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@RequestBody</span> Brand brand<span style="color:#f92672">,</span><span style="color:#a6e22e">@PathVariable</span> Integer id<span style="color:#f92672">){</span>
    <span style="color:#75715e">//设置ID
</span><span style="color:#75715e"></span>    brand<span style="color:#f92672">.</span><span style="color:#a6e22e">setId</span><span style="color:#f92672">(</span>id<span style="color:#f92672">);</span>
    <span style="color:#75715e">//修改数据
</span><span style="color:#75715e"></span>    brandService<span style="color:#f92672">.</span><span style="color:#a6e22e">update</span><span style="color:#f92672">(</span>brand<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Result<span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>StatusCode<span style="color:#f92672">.</span><span style="color:#a6e22e">OK</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;修改成功&#34;</span><span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>测试：http://localhost:18081/brand/325415</p>
<p><img src="image%5C1560444209790.png" alt="1560444209790"></p>
<h4 id="435-删除品牌">4.3.5 删除品牌</h4>
<p>(1)业务层</p>
<p>修改com.changgou.goods.service.BrandService，添加删除品牌方法，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 删除品牌
</span><span style="color:#75715e"> * @param id
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">delete</span><span style="color:#f92672">(</span>Integer id<span style="color:#f92672">);</span>
</code></pre></div><p>修改com.changgou.goods.service.impl.BrandServiceImpl，新增删除品牌方法，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * 删除
</span><span style="color:#75715e"> * @param id
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@Override</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">delete</span><span style="color:#f92672">(</span>Integer id<span style="color:#f92672">){</span>
    brandMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">deleteByPrimaryKey</span><span style="color:#f92672">(</span>id<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>(2)控制层</p>
<p>BrandController新增方法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 根据ID删除品牌数据
</span><span style="color:#75715e"> * @param id
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@DeleteMapping</span><span style="color:#f92672">(</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/{id}&#34;</span> <span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> Result <span style="color:#a6e22e">delete</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@PathVariable</span> Integer id<span style="color:#f92672">){</span>
    brandService<span style="color:#f92672">.</span><span style="color:#a6e22e">delete</span><span style="color:#f92672">(</span>id<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Result<span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>StatusCode<span style="color:#f92672">.</span><span style="color:#a6e22e">OK</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;删除成功&#34;</span><span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>测试：http://localhost:18081/brand/325415</p>
<p><img src="image%5C1560444351992.png" alt="1560444351992"></p>
<h4 id="436-品牌列表条件查询">4.3.6 品牌列表条件查询</h4>
<p>(1)业务层</p>
<p>修改com.changgou.goods.service.BrandService，增加根据条件搜索品牌方法，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 多条件搜索品牌方法
</span><span style="color:#75715e"> * @param brand
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
List<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findList</span><span style="color:#f92672">(</span>Brand brand<span style="color:#f92672">);</span>
</code></pre></div><p>修改com.changgou.goods.service.impl.BrandServiceImpl，添加根据多条件搜索品牌方法的实现，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * 条件查询
</span><span style="color:#75715e"> * @param brand
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@Override</span>
<span style="color:#66d9ef">public</span> List<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findList</span><span style="color:#f92672">(</span>Brand brand<span style="color:#f92672">){</span>
    <span style="color:#75715e">//构建查询条件
</span><span style="color:#75715e"></span>    Example example <span style="color:#f92672">=</span> createExample<span style="color:#f92672">(</span>brand<span style="color:#f92672">);</span>
    <span style="color:#75715e">//根据构建的条件查询数据
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> brandMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectByExample</span><span style="color:#f92672">(</span>example<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>


<span style="color:#75715e">/**
</span><span style="color:#75715e"> * 构建查询对象
</span><span style="color:#75715e"> * @param brand
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">public</span> Example <span style="color:#a6e22e">createExample</span><span style="color:#f92672">(</span>Brand brand<span style="color:#f92672">){</span>
    Example example<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> Example<span style="color:#f92672">(</span>Brand<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
    Example<span style="color:#f92672">.</span><span style="color:#a6e22e">Criteria</span> criteria <span style="color:#f92672">=</span> example<span style="color:#f92672">.</span><span style="color:#a6e22e">createCriteria</span><span style="color:#f92672">();</span>
    <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>brand<span style="color:#f92672">!=</span><span style="color:#66d9ef">null</span><span style="color:#f92672">){</span>
        <span style="color:#75715e">// 品牌名称
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span><span style="color:#f92672">(!</span>StringUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">isEmpty</span><span style="color:#f92672">(</span>brand<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">())){</span>
            criteria<span style="color:#f92672">.</span><span style="color:#a6e22e">andLike</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;%&#34;</span><span style="color:#f92672">+</span>brand<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;%&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">// 品牌图片地址
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span><span style="color:#f92672">(!</span>StringUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">isEmpty</span><span style="color:#f92672">(</span>brand<span style="color:#f92672">.</span><span style="color:#a6e22e">getImage</span><span style="color:#f92672">())){</span>
            criteria<span style="color:#f92672">.</span><span style="color:#a6e22e">andLike</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;image&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;%&#34;</span><span style="color:#f92672">+</span>brand<span style="color:#f92672">.</span><span style="color:#a6e22e">getImage</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;%&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">// 品牌的首字母
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span><span style="color:#f92672">(!</span>StringUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">isEmpty</span><span style="color:#f92672">(</span>brand<span style="color:#f92672">.</span><span style="color:#a6e22e">getLetter</span><span style="color:#f92672">())){</span>
            criteria<span style="color:#f92672">.</span><span style="color:#a6e22e">andLike</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;letter&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;%&#34;</span><span style="color:#f92672">+</span>brand<span style="color:#f92672">.</span><span style="color:#a6e22e">getLetter</span><span style="color:#f92672">()+</span><span style="color:#e6db74">&#34;%&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">// 品牌id
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span><span style="color:#f92672">(!</span>StringUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">isEmpty</span><span style="color:#f92672">(</span>brand<span style="color:#f92672">.</span><span style="color:#a6e22e">getLetter</span><span style="color:#f92672">())){</span>
            criteria<span style="color:#f92672">.</span><span style="color:#a6e22e">andEqualTo</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">,</span>brand<span style="color:#f92672">.</span><span style="color:#a6e22e">getId</span><span style="color:#f92672">());</span>
        <span style="color:#f92672">}</span>
        <span style="color:#75715e">// 排序
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span><span style="color:#f92672">(!</span>StringUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">isEmpty</span><span style="color:#f92672">(</span>brand<span style="color:#f92672">.</span><span style="color:#a6e22e">getSeq</span><span style="color:#f92672">())){</span>
            criteria<span style="color:#f92672">.</span><span style="color:#a6e22e">andEqualTo</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;seq&#34;</span><span style="color:#f92672">,</span>brand<span style="color:#f92672">.</span><span style="color:#a6e22e">getSeq</span><span style="color:#f92672">());</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
    <span style="color:#66d9ef">return</span> example<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>(2) 控制层</p>
<p>BrandController新增方法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 多条件搜索品牌数据
</span><span style="color:#75715e"> * @param brand
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@PostMapping</span><span style="color:#f92672">(</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/search&#34;</span> <span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> Result<span style="color:#f92672">&lt;</span>List<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;&gt;</span> <span style="color:#a6e22e">findList</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@RequestBody</span><span style="color:#f92672">(</span>required <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">)</span> Brand brand<span style="color:#f92672">){</span>
    List<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> list <span style="color:#f92672">=</span> brandService<span style="color:#f92672">.</span><span style="color:#a6e22e">findList</span><span style="color:#f92672">(</span>brand<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Result<span style="color:#f92672">&lt;</span>List<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;&gt;(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>StatusCode<span style="color:#f92672">.</span><span style="color:#a6e22e">OK</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;查询成功&#34;</span><span style="color:#f92672">,</span>list<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>测试：http://localhost:18081/brand/search</p>
<p><img src="image%5C1560445027032.png" alt="1560445027032"></p>
<h4 id="437-品牌列表分页查询">4.3.7 品牌列表分页查询</h4>
<p>(1)业务层</p>
<p>修改com.changgou.goods.service.BrandService添加分页方法，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 分页查询
</span><span style="color:#75715e"> * @param page
</span><span style="color:#75715e"> * @param size
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
PageInfo<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findPage</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> page<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> size<span style="color:#f92672">);</span>
</code></pre></div><p>修改com.changgou.goods.service.impl.BrandServiceImpl添加分页方法实现，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * 分页查询
</span><span style="color:#75715e"> * @param page
</span><span style="color:#75715e"> * @param size
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@Override</span>
<span style="color:#66d9ef">public</span> PageInfo<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findPage</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> page<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> size<span style="color:#f92672">){</span>
    <span style="color:#75715e">//静态分页
</span><span style="color:#75715e"></span>    PageHelper<span style="color:#f92672">.</span><span style="color:#a6e22e">startPage</span><span style="color:#f92672">(</span>page<span style="color:#f92672">,</span>size<span style="color:#f92672">);</span>
    <span style="color:#75715e">//分页查询
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> PageInfo<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;(</span>brandMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectAll</span><span style="color:#f92672">());</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>(2)控制层</p>
<p>BrandController新增方法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 分页搜索实现
</span><span style="color:#75715e"> * @param page:当前页
</span><span style="color:#75715e"> * @param size:每页显示多少条
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@GetMapping</span><span style="color:#f92672">(</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/search/{page}/{size}&#34;</span> <span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> Result<span style="color:#f92672">&lt;</span>PageInfo<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findPage</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@PathVariable</span>  <span style="color:#66d9ef">int</span> page<span style="color:#f92672">,</span> <span style="color:#a6e22e">@PathVariable</span>  <span style="color:#66d9ef">int</span> size<span style="color:#f92672">){</span>
    <span style="color:#75715e">//分页查询
</span><span style="color:#75715e"></span>    PageInfo<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> pageInfo <span style="color:#f92672">=</span> brandService<span style="color:#f92672">.</span><span style="color:#a6e22e">findPage</span><span style="color:#f92672">(</span>page<span style="color:#f92672">,</span> size<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Result<span style="color:#f92672">&lt;</span>PageInfo<span style="color:#f92672">&gt;(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>StatusCode<span style="color:#f92672">.</span><span style="color:#a6e22e">OK</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;查询成功&#34;</span><span style="color:#f92672">,</span>pageInfo<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>测试：http://localhost:18081/brand/search/1/3</p>
<p><img src="image%5C1560446429340.png" alt="1560446429340"></p>
<h4 id="438-品牌列表条件分页查询">4.3.8 品牌列表条件+分页查询</h4>
<p>(1)业务层</p>
<p>修改com.changgou.goods.service.BrandService，增加多条件分页查询方法，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 多条件分页查询
</span><span style="color:#75715e"> * @param brand
</span><span style="color:#75715e"> * @param page
</span><span style="color:#75715e"> * @param size
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
PageInfo<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findPage</span><span style="color:#f92672">(</span>Brand brand<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> page<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> size<span style="color:#f92672">);</span>
</code></pre></div><p>修改com.changgou.goods.service.impl.BrandServiceImpl，添加多条件分页查询方法代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * 条件+分页查询
</span><span style="color:#75715e"> * @param brand 查询条件
</span><span style="color:#75715e"> * @param page 页码
</span><span style="color:#75715e"> * @param size 页大小
</span><span style="color:#75715e"> * @return 分页结果
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@Override</span>
<span style="color:#66d9ef">public</span> PageInfo<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findPage</span><span style="color:#f92672">(</span>Brand brand<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> page<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> size<span style="color:#f92672">){</span>
    <span style="color:#75715e">//分页
</span><span style="color:#75715e"></span>    PageHelper<span style="color:#f92672">.</span><span style="color:#a6e22e">startPage</span><span style="color:#f92672">(</span>page<span style="color:#f92672">,</span>size<span style="color:#f92672">);</span>
    <span style="color:#75715e">//搜索条件构建
</span><span style="color:#75715e"></span>    Example example <span style="color:#f92672">=</span> createExample<span style="color:#f92672">(</span>brand<span style="color:#f92672">);</span>
    <span style="color:#75715e">//执行搜索
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> PageInfo<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;(</span>brandMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectByExample</span><span style="color:#f92672">(</span>example<span style="color:#f92672">));</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>(2)控制层</p>
<p>BrandController新增方法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/***
</span><span style="color:#75715e"> * 分页搜索实现
</span><span style="color:#75715e"> * @param brand
</span><span style="color:#75715e"> * @param page
</span><span style="color:#75715e"> * @param size
</span><span style="color:#75715e"> * @return
</span><span style="color:#75715e"> */</span>
<span style="color:#a6e22e">@PostMapping</span><span style="color:#f92672">(</span>value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/search/{page}/{size}&#34;</span> <span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> Result<span style="color:#f92672">&lt;</span>PageInfo<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findPage</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@RequestBody</span><span style="color:#f92672">(</span>required <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">)</span> Brand brand<span style="color:#f92672">,</span> <span style="color:#a6e22e">@PathVariable</span>  <span style="color:#66d9ef">int</span> page<span style="color:#f92672">,</span> <span style="color:#a6e22e">@PathVariable</span>  <span style="color:#66d9ef">int</span> size<span style="color:#f92672">){</span>
    <span style="color:#75715e">//执行搜索
</span><span style="color:#75715e"></span>    PageInfo<span style="color:#f92672">&lt;</span>Brand<span style="color:#f92672">&gt;</span> pageInfo <span style="color:#f92672">=</span> brandService<span style="color:#f92672">.</span><span style="color:#a6e22e">findPage</span><span style="color:#f92672">(</span>brand<span style="color:#f92672">,</span> page<span style="color:#f92672">,</span> size<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Result<span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">,</span>StatusCode<span style="color:#f92672">.</span><span style="color:#a6e22e">OK</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;查询成功&#34;</span><span style="color:#f92672">,</span>pageInfo<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>测试：http://localhost:18081/brand/search/1/3</p>
<p><img src="image%5C1560446545220.png" alt="1560446545220"></p>
<h4 id="439-公共异常处理">4.3.9 公共异常处理</h4>
<p>为了使我们的代码更容易维护，我们创建一个类集中处理异常,该异常类可以创建在changgou-common工程中，创建com.changgou.framework.exception.BaseExceptionHandler，代码如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@ControllerAdvice</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BaseExceptionHandler</span> <span style="color:#f92672">{</span>

    <span style="color:#75715e">/***
</span><span style="color:#75715e">     * 异常处理
</span><span style="color:#75715e">     * @param e
</span><span style="color:#75715e">     * @return
</span><span style="color:#75715e">     */</span>
    <span style="color:#a6e22e">@ExceptionHandler</span><span style="color:#f92672">(</span>value <span style="color:#f92672">=</span> Exception<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
    <span style="color:#a6e22e">@ResponseBody</span>
    <span style="color:#66d9ef">public</span> Result <span style="color:#a6e22e">error</span><span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Result<span style="color:#f92672">(</span><span style="color:#66d9ef">false</span><span style="color:#f92672">,</span> StatusCode<span style="color:#f92672">.</span><span style="color:#a6e22e">ERROR</span><span style="color:#f92672">,</span> e<span style="color:#f92672">.</span><span style="color:#a6e22e">getMessage</span><span style="color:#f92672">());</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>注意：@ControllerAdvice注解，全局捕获异常类，只要作用在@RequestMapping上，所有的异常都会被捕获。</p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
